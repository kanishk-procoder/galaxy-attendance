<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galaxy Attendance ‚Äì Final</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#020617">

<style>
:root{
  --bg:#020617;--card:#0b1028;--text:#e5e7eb;--accent:#7c3aed;
  --present:#22c55e;--absent:#ef4444;--od:#eab308;--warn:#f97316;
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;min-height:100vh;color:var(--text);
  background:
    radial-gradient(circle at 20% 30%, #312e81, transparent 40%),
    radial-gradient(circle at 80% 70%, #020617, transparent 40%),
    var(--bg);
  padding:14px;
}

/* Galaxy background */
.stars{position:fixed;inset:0;pointer-events:none;opacity:.25;background:url('https://raw.githubusercontent.com/JulianLaval/canvas-particle-network/master/img/stars.png');animation:move 160s linear infinite}
@keyframes move{to{background-position:-3000px 3000px}}

h1{text-align:center;margin:6px 0;letter-spacing:1px}
.subtitle{text-align:center;opacity:.7;margin-bottom:10px}

.tabs{display:flex;gap:10px;justify-content:center;margin-bottom:14px}
.tabs button{flex:1;max-width:200px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.15);color:var(--text);padding:12px;border-radius:18px;font-weight:600}
.tabs button.active{background:linear-gradient(135deg,#7c3aed,#2563eb)}

.tab{display:none}.tab.active{display:block}

.card{background:rgba(15,23,42,.9);border-radius:20px;padding:14px;margin-bottom:14px;box-shadow:0 0 50px rgba(124,58,237,.25)}

.subject{font-size:1.15rem;margin-bottom:4px}
.meta{opacity:.8;font-size:.85rem}
.remark{margin-top:6px;font-size:.85rem;opacity:.9}

.actions{display:flex;gap:6px;margin-top:10px}
.actions button{flex:1;border:none;border-radius:12px;padding:8px;color:#fff;font-weight:600}
.present{background:var(--present)}.absent{background:var(--absent)}.od{background:var(--od)}.dismiss{background:#64748b}

.circle{width:120px;height:120px;border-radius:50%;margin:10px auto;display:flex;align-items:center;justify-content:center;font-weight:700}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}

.alert{background:rgba(249,115,22,.15);border:1px solid var(--warn);padding:10px;border-radius:16px;margin-bottom:12px;color:#fed7aa}

/* Toast */
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#020617;border:1px solid var(--accent);padding:10px 18px;border-radius:20px;opacity:0;transition:.4s}
.toast.show{opacity:1}

footer{text-align:center;opacity:.6;font-size:.85rem;margin:14px}
</style>
</head>
<body>
<div class="stars"></div>
<h1>üåå Galaxy Attendance</h1>
<div class="subtitle" id="today"></div>

<div class="tabs">
  <button class="active" onclick="tab('todayTab',this)">üìÖ Today</button>
  <button onclick="tab('statsTab',this)">üìä Attendance</button>
</div>

<div class="tab active" id="todayTab"></div>
<div class="tab" id="statsTab">
  <div id="alerts"></div>
  <div class="card">
    <h3 style="text-align:center">Overall Attendance</h3>
    <div class="circle" id="overall"></div>
    <p id="overallText" style="text-align:center"></p>
    <p id="overallPlan" style="text-align:center;opacity:.8"></p>
  </div>
  <h3 style="text-align:center">Subject-wise Analytics</h3>
  <div class="grid" id="subjects"></div>
</div>

<div class="toast" id="toast"></div>
<footer>üå† Complete Analytics ‚Ä¢ 75% Logic ‚Ä¢ Galaxy Theme</footer>

<script>
/* ===== USER ===== */
if(!localStorage.user){const u=prompt('Username (sync)');if(u)localStorage.user=u}
const KEY=`galaxy-${localStorage.user||'guest'}`;
let store=JSON.parse(localStorage.getItem(KEY)||'{}');
function save(){localStorage.setItem(KEY,JSON.stringify(store))}

/* ===== DATE ===== */
const days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
const todayName=days[new Date().getDay()];
document.getElementById('today').innerText=todayName;

/* ===== COMPLETE TIMETABLE ===== */
const timetable={
  Monday:[
    {s:'Artificial Intelligence',t:'8:15‚Äì9:15',r:'305',f:'Nidhi Srivastav'},
    {s:'DIP',t:'9:15‚Äì10:15',r:'305',f:'Mamta Jain'},
    {s:'CAO',t:'10:15‚Äì11:15',r:'305',f:'Abdul Naim Khan'},
    {s:'NLP',t:'12:00‚Äì1:00',r:'305',f:'Mani Butwall'},
    {s:'Machine Learning',t:'1:00‚Äì2:00',r:'305',f:'Nikita Gautam'},
    {s:'Cloud Computing',t:'2:00‚Äì3:00',r:'305',f:'Aakriti Sharma'}
  ],
  Tuesday:[
    {s:'NLP',t:'8:15‚Äì9:15',r:'306',f:'Mani Butwall'},
    {s:'Machine Learning',t:'9:15‚Äì10:15',r:'306',f:'Nikita Gautam'},
    {s:'CRT Lab',t:'10:15‚Äì12:15',r:'7F-EE',f:'Neha Mathur'},
    {s:'ISS',t:'1:00‚Äì2:00',r:'304',f:'Palika Jajoo'},
    {s:'CAO',t:'2:00‚Äì3:00',r:'306',f:'Abdul Naim Khan'}
  ],
  Wednesday:[
    {s:'Python Lab',t:'8:15‚Äì11:15',r:'Lab 18',f:'Rajesh Rajan'},
    {s:'Machine Learning',t:'12:00‚Äì1:00',r:'303',f:'Nikita Gautam'},
    {s:'Cloud Computing',t:'1:00‚Äì2:00',r:'303',f:'Aakriti Sharma'}
  ],
  Thursday:[
    {s:'CRT Lab',t:'8:15‚Äì10:15',r:'7F-EE',f:'Harpreet Singh Gill'},
    {s:'Artificial Intelligence',t:'10:15‚Äì11:15',r:'305',f:'Nidhi Srivastav'},
    {s:'DIP Lab',t:'12:00‚Äì3:00',r:'Lab 20',f:'Abdul Naim Khan'}
  ],
  Friday:[
    {s:'MAD Lab',t:'8:15‚Äì11:15',r:'Lab 13',f:'Palika Jajoo'},
    {s:'ISS',t:'12:00‚Äì1:00',r:'306',f:'Palika Jajoo'},
    {s:'Cloud Computing',t:'1:00‚Äì2:00',r:'306',f:'Aakriti Sharma'},
    {s:'CAO',t:'2:00‚Äì3:00',r:'306',f:'Abdul Naim Khan'}
  ],
  Saturday:[
    {s:'Machine Learning Lab',t:'8:15‚Äì11:15',r:'7F-CP7',f:'Manish Kumar Sharma'},
    {s:'DIP',t:'12:00‚Äì1:00',r:'106',f:'Mamta Jain'},
    {s:'CRT Lab',t:'1:00‚Äì3:00',r:'7F-EE',f:'Ashish Pant'}
  ]
};

/* ===== HELPERS ===== */
function toast(msg){const t=document.getElementById('toast');t.innerText=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),5000)}
function mark(c,status){
  const s=c.s;store[s]=store[s]||{p:0,a:0};
  if(status==='Present'||status==='OD') store[s].p++;
  if(status==='Absent') store[s].a++;
  save();toast(`‚úî ${status} marked for ${s} (done in 5s)`);
  renderStats();
}
function circle(el,p){el.style.background=`conic-gradient(var(--accent) ${p}%,#1e293b 0)`;el.innerText=Math.round(p)+'%'}

/* ===== TODAY ===== */
const todayDiv=document.getElementById('todayTab');
if(!timetable[todayName]) todayDiv.innerHTML='<div class=card>No classes üéâ</div>';
else timetable[todayName].forEach(c=>{
  const d=document.createElement('div');d.className='card';
  d.innerHTML=`<div class=subject>${c.s}</div>
    <div class=meta>üïí ${c.t} | üè´ ${c.r} | üë©‚Äçüè´ ${c.f}</div>
    <div class=actions>
      <button class=present onclick='mark(${JSON.stringify(c)},"Present")'>Present</button>
      <button class=od onclick='mark(${JSON.stringify(c)},"OD")'>OD</button>
      <button class=absent onclick='mark(${JSON.stringify(c)},"Absent")'>Absent</button>
      <button class=dismiss>Dismiss</button>
    </div>`;
  todayDiv.appendChild(d);
});

/* ===== STATS ===== */
function renderStats(){
  let P=0,A=0;Object.values(store).forEach(v=>{P+=v.p;A+=v.a});
  const tot=P+A,per=tot?P/tot*100:0;
  circle(document.getElementById('overall'),per);

  const alerts=document.getElementById('alerts');alerts.innerHTML='';
  if(per<75) alerts.innerHTML='<div class=alert>‚ö† Attendance below 75%!</div>';

  const needAttend=Math.max(0,Math.ceil((0.75*tot-P)/0.25));
  const canSkip=Math.max(0,Math.floor((P/0.75)-tot));
  document.getElementById('overallText').innerText=`Attendance: ${Math.round(per)}%`;
  document.getElementById('overallPlan').innerText=
    per>=75?`You can skip ${canSkip} more classes`:
    `Attend next ${needAttend} classes to reach 75%`;

  const g=document.getElementById('subjects');g.innerHTML='';
  for(const[s,v]of Object.entries(store)){
    const t=v.p+v.a,p=t?v.p/t*100:0;
    const need=Math.max(0,Math.ceil((0.75*t-v.p)/0.25));
    const skip=Math.max(0,Math.floor((v.p/0.75)-t));
    const c=document.createElement('div');c.className='card';
    c.innerHTML=`<h4 style=text-align:center>${s}</h4>
      <div class=circle></div>
      <p style=text-align:center>P:${v.p} A:${v.a}</p>
      <p style=text-align:center;opacity:.85>${p>=75?`Skip ${skip}`:`Attend ${need}`}</p>`;
    g.appendChild(c);circle(c.querySelector('.circle'),p);
  }
}
renderStats();

/* ===== TABS ===== */
function tab(id,btn){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active'));document.getElementById(id).classList.add('active');btn.classList.add('active')}

if('serviceWorker'in navigator)navigator.serviceWorker.register('sw.js');
</script>
</body>
</html>
